<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chinese Character Detective - Learn Chinese Characters</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            color: #e6e6e6;
            overflow-x: hidden;
        }
        
        .container {
            width: 100%;
            max-width: 1000px;
            background: rgba(30, 30, 46, 0.9);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            padding: 30px;
            margin-top: 20px;
            position: relative;
            overflow: hidden;
            border: 1px solid #39395a;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
            z-index: 1;
        }
        
        h1 {
            color: #e6e6e6;
            margin-bottom: 10px;
            font-size: 2.5rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .subtitle {
            color: #a0a0c0;
            font-size: 1.2rem;
        }
        
        .game-area {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            position: relative;
            z-index: 1;
        }
        
        .story-panel {
            flex: 1;
            min-width: 300px;
            background: rgba(40, 40, 60, 0.7);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            border: 1px solid #4a4a6a;
        }
        
        .game-panel {
            flex: 2;
            min-width: 400px;
            background: rgba(40, 40, 60, 0.7);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            border: 1px solid #4a4a6a;
        }
        
        .chapter-title {
            background: linear-gradient(90deg, #0ea5e9, #6366f1);
            color: white;
            padding: 12px 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
            font-size: 1.3rem;
            font-weight: 600;
            letter-spacing: 0.5px;
        }
        
        .story-content {
            background: rgba(50, 50, 70, 0.8);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            min-height: 180px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            line-height: 1.6;
            border-left: 4px solid #6366f1;
        }
        
        .character-display {
            font-size: 140px;
            text-align: center;
            margin: 20px 0;
            color: #f8fafc;
            height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(30, 30, 46, 0.8);
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            border: 1px solid #4a4a6a;
            text-shadow: 0 0 10px rgba(99, 102, 241, 0.5);
        }
        
        .character-info {
            background: rgba(50, 50, 70, 0.8);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #10b981;
        }
        
        .pinyin {
            font-size: 1.8rem;
            color: #f59e0b;
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .meaning {
            font-size: 1.2rem;
            color: #e6e6e6;
            margin-bottom: 10px;
        }
        
        .example {
            font-size: 1rem;
            color: #a0a0c0;
            font-style: italic;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid #4a4a6a;
        }
        
        .input-area {
            margin-top: 20px;
        }
        
        input {
            width: 100%;
            padding: 14px 15px;
            border: 2px solid #4a4a6a;
            border-radius: 8px;
            font-size: 1.1rem;
            margin-bottom: 15px;
            transition: border-color 0.3s;
            background: rgba(30, 30, 46, 0.8);
            color: #e6e6e6;
        }
        
        input:focus {
            border-color: #6366f1;
            outline: none;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
        }
        
        input::placeholder {
            color: #8a8aa8;
        }
        
        button {
            background: linear-gradient(90deg, #0ea5e9, #6366f1);
            color: white;
            border: none;
            padding: 14px 20px;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
            margin-bottom: 10px;
            font-weight: 600;
            letter-spacing: 0.5px;
        }
        
        button:hover {
            background: linear-gradient(90deg, #0284c7, #4f46e5);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .btn-secondary {
            background: linear-gradient(90deg, #10b981, #059669);
        }
        
        .btn-secondary:hover {
            background: linear-gradient(90deg, #059669, #047857);
        }
        
        .progress-container {
            margin: 20px 0;
        }
        
        .progress-bar {
            height: 12px;
            background: rgba(40, 40, 60, 0.8);
            border-radius: 6px;
            margin: 10px 0;
            overflow: hidden;
            border: 1px solid #4a4a6a;
        }
        
        .progress {
            height: 100%;
            background: linear-gradient(90deg, #10b981, #059669);
            width: 30%;
            transition: width 0.5s;
            border-radius: 6px;
        }
        
        .hint {
            background: rgba(245, 158, 11, 0.1);
            border-left: 4px solid #f59e0b;
            padding: 12px 15px;
            margin: 15px 0;
            border-radius: 0 5px 5px 0;
            font-size: 0.95rem;
            color: #fcd34d;
        }
        
        .character-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            margin-top: 20px;
        }
        
        .character-card {
            background: rgba(50, 50, 70, 0.8);
            border-radius: 8px;
            padding: 15px 5px;
            text-align: center;
            box-shadow: 0 3px 5px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            border: 1px solid #4a4a6a;
        }
        
        .character-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.15);
            border-color: #6366f1;
        }
        
        .character-card .char {
            font-size: 1.8rem;
            margin-bottom: 5px;
            color: #f8fafc;
        }
        
        .character-card .pinyin {
            font-size: 0.8rem;
            color: #f59e0b;
        }
        
        .success {
            color: #10b981;
            font-weight: bold;
            text-align: center;
            margin: 10px 0;
            padding: 12px;
            background: rgba(16, 185, 129, 0.1);
            border-radius: 5px;
            border: 1px solid #10b981;
        }
        
        .error {
            color: #ef4444;
            font-weight: bold;
            text-align: center;
            margin: 10px 0;
            padding: 12px;
            background: rgba(239, 68, 68, 0.1);
            border-radius: 5px;
            border: 1px solid #ef4444;
        }
        
        .stats {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            font-size: 0.9rem;
            color: #a0a0c0;
        }
        
        .npc-image {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, #6366f1, #0ea5e9);
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .story-controls {
            display: flex;
            gap: 10px;
        }
        
        .story-controls button {
            flex: 1;
        }
        
        @media (max-width: 768px) {
            .game-area {
                flex-direction: column;
            }
            
            .character-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }
        
        @media (max-width: 480px) {
            .character-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .character-display {
                font-size: 100px;
                height: 150px;
            }
        }
        
        .decoration {
            position: absolute;
            opacity: 0.05;
            font-size: 120px;
            z-index: 0;
            color: #e6e6e6;
        }
        
        .dec-1 {
            top: 10%;
            left: 5%;
        }
        
        .dec-2 {
            top: 60%;
            right: 5%;
        }
        
        .dec-3 {
            bottom: 10%;
            left: 10%;
        }
        
        .floating {
            animation: float 6s ease-in-out infinite;
        }
        
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        
        .celebration {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(16, 185, 129, 0.9);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 100;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s;
        }
        
        .celebration.active {
            opacity: 1;
            pointer-events: all;
        }
        
        .celebration h2 {
            font-size: 3rem;
            color: white;
            margin-bottom: 20px;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        
        .celebration p {
            font-size: 1.5rem;
            color: white;
            text-align: center;
            max-width: 600px;
            margin-bottom: 30px;
        }
        
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #f59e0b;
            opacity: 0.8;
        }
        
        .music-control {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(40, 40, 60, 0.8);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: 1px solid #4a4a6a;
            z-index: 10;
        }
        
        .music-control i {
            color: #a0a0c0;
            font-size: 1.2rem;
        }
    </style>
</head>
<body>
    <div class="music-control" id="music-control">
        <i>♪</i>
    </div>
    
    <header>
        <h1>Chinese Character Detective</h1>
        <p class="subtitle">Unlock the mysteries of Chinese characters through interactive stories</p>
    </header>
    
    <div class="container">
        <div class="decoration dec-1 floating">汉</div>
        <div class="decoration dec-2 floating">字</div>
        <div class="decoration dec-3 floating">学</div>
        
        <div class="chapter-title">Chapter 1: The Detective Agency</div>
        
        <div class="game-area">
            <div class="story-panel">
                <div class="npc-image">社</div>
                <div class="story-content">
                    <p>Welcome to the Chinese Character Detective Agency! I'm Director Li Ming.</p>
                    <p>Our agency specializes in solving mysteries related to Chinese characters. We've received many cases recently, but we're short on staff.</p>
                    <p>As a new member, you need to master some basic characters first. Let's start with the simplest ones!</p>
                    <p><strong>Mission:</strong> Learn 5 basic characters and pass the entry test.</p>
                </div>
                
                <div class="progress-container">
                    <div>Story Progress</div>
                    <div class="progress-bar">
                        <div class="progress" id="story-progress"></div>
                    </div>
                    <div class="stats">
                        <div>Chapter: <span id="chapter-num">1</span>/6</div>
                        <div>Task: <span id="task-progress">1</span>/5</div>
                    </div>
                </div>
                
                <div class="story-controls">
                    <button id="prev-btn">Previous Task</button>
                    <button id="next-btn" class="btn-secondary">Next Task</button>
                </div>
            </div>
            
            <div class="game-panel">
                <div class="character-display" id="current-character">你</div>
                
                <div class="character-info">
                    <div class="pinyin" id="pinyin">nǐ</div>
                    <div class="meaning" id="meaning">You - Second person pronoun</div>
                    <div class="example" id="example">Example: 你好！(Nǐ hǎo! - Hello!)</div>
                </div>
                
                <div class="hint">
                    <strong>Detective Tip:</strong> This character represents the second person, used to address someone. In Chinese, it's the counterpart to "I" (wǒ).
                </div>
                
                <div class="input-area">
                    <input type="text" id="answer-input" placeholder="Enter the meaning of this character...">
                    <button id="submit-btn">Submit Answer</button>
                    <div id="result-message"></div>
                </div>
                
                <div class="progress-container">
                    <div>Learning Progress</div>
                    <div class="progress-bar">
                        <div class="progress" id="learning-progress"></div>
                    </div>
                    <div class="stats">
                        <div>Learned: <span id="learned-count">1</span>/30</div>
                        <div>Accuracy: <span id="accuracy">100%</span></div>
                    </div>
                </div>
                
                <h3>Unlocked Characters</h3>
                <div class="character-grid" id="character-grid">
                    <!-- Character cards will be generated dynamically by JavaScript -->
                </div>
            </div>
        </div>
    </div>
    
    <div class="celebration" id="celebration">
        <h2>Congratulations!</h2>
        <p>You've successfully solved this character puzzle!</p>
        <p>Moving to the next challenge...</p>
    </div>

    <script>
        // Background music (placeholder - in a real implementation, you would use actual audio files)
        const backgroundMusic = {
            play: function() {
                console.log("Background music playing");
                // In a real implementation: document.getElementById("bg-music").play();
            },
            pause: function() {
                console.log("Background music paused");
                // In a real implementation: document.getElementById("bg-music").pause();
            }
        };
        
        // Music control
        const musicControl = document.getElementById('music-control');
        let musicPlaying = false;
        
        musicControl.addEventListener('click', function() {
            if (musicPlaying) {
                backgroundMusic.pause();
                musicControl.innerHTML = '<i>♪</i>';
                musicPlaying = false;
            } else {
                backgroundMusic.play();
                musicControl.innerHTML = '<i>♫</i>';
                musicPlaying = true;
            }
        });
        
        // Story chapters data
        const storyChapters = [
            {
                title: "Chapter 1: The Detective Agency",
                npc: "社",
                story: "Welcome to the Chinese Character Detective Agency! I'm Director Li Ming. Our agency specializes in solving mysteries related to Chinese characters. We've received many cases recently, but we're short on staff. As a new member, you need to master some basic characters first. Let's start with the simplest ones!",
                task: "Learn 5 basic characters and pass the entry test.",
                characters: [0, 1, 2, 3, 4] // character indices
            },
            {
                title: "Chapter 2: The Missing Friend",
                npc: "学",
                story: "A university student named Xiao Li came to us for help. His friend Xiao Wang disappeared yesterday. Xiao Wang only left a note, but the handwriting is blurry. We need to decipher the characters on the note to find out where Xiao Wang went.",
                task: "Decipher the note and find Xiao Wang.",
                characters: [5, 6, 7, 8, 9]
            },
            {
                title: "Chapter 3: The Mysterious Gift",
                npc: "礼",
                story: "Today is Mary's birthday, and she received an anonymous gift. The gift box has a series of character puzzles. Only by solving the puzzles can she find out who sent the gift. Mary really wants to know who sent it. Can you help her?",
                task: "Solve the character puzzles on the gift.",
                characters: [10, 11, 12, 13, 14]
            },
            {
                title: "Chapter 4: The Time Puzzle",
                npc: "时",
                story: "A foreign tourist is lost at the train station. He needs to catch the 3 PM train, but he can't read the Chinese schedule. We need to help him understand the time-related characters so he can board the train on time.",
                task: "Help the tourist read the schedule.",
                characters: [15, 16, 17, 18, 19]
            },
            {
                title: "Chapter 5: The Family Album",
                npc: "家",
                story: "An elderly lady wants to organize her family photo album, but the character labels in the album have faded. She hopes we can help identify these characters to recover precious family memories.",
                task: "Identify the family member titles in the album.",
                characters: [20, 21, 22, 23, 24]
            },
            {
                title: "Chapter 6: The Final Challenge",
                npc: "侦",
                story: "Congratulations! You've mastered a lot of Chinese character knowledge. Now, the Director will give you the final test. Pass this test, and you'll become an official member of the Chinese Character Detective Agency!",
                task: "Pass the final test and become an official detective.",
                characters: [25, 26, 27, 28, 29]
            }
        ];

        // Character data
        const characters = [
            { char: '你', pinyin: 'nǐ', meaning: 'You - Second person pronoun', example: 'Example: 你好！(Nǐ hǎo! - Hello!)' },
            { char: '好', pinyin: 'hǎo', meaning: 'Good - Expresses positivity or agreement', example: 'Example: 你好！(Nǐ hǎo! - Hello!)' },
            { char: '我', pinyin: 'wǒ', meaning: 'I/Me - First person pronoun', example: 'Example: 我叫小明。(Wǒ jiào Xiǎomíng. - My name is Xiaoming.)' },
            { char: '叫', pinyin: 'jiào', meaning: 'To call - Used for naming or addressing', example: 'Example: 你叫什么名字？(Nǐ jiào shénme míngzì? - What is your name?)' },
            { char: '是', pinyin: 'shì', meaning: 'To be - Expresses affirmation or confirmation', example: 'Example: 我是学生。(Wǒ shì xuéshēng. - I am a student.)' },
            { char: '人', pinyin: 'rén', meaning: 'Person - Human being', example: 'Example: 中国人 (Zhōngguó rén - Chinese person)' },
            { char: '他', pinyin: 'tā', meaning: 'He - Third person masculine', example: 'Example: 他是老师。(Tā shì lǎoshī. - He is a teacher.)' },
            { char: '她', pinyin: 'tā', meaning: 'She - Third person feminine', example: 'Example: 她是学生。(Tā shì xuéshēng. - She is a student.)' },
            { char: '们', pinyin: 'men', meaning: 'Plural marker - Indicates plurality', example: 'Example: 我们 (wǒmen - we)' },
            { char: '老师', pinyin: 'lǎoshī', meaning: 'Teacher - Educator', example: 'Example: 张老师 (Zhāng lǎoshī - Teacher Zhang)' },
            { char: '生日', pinyin: 'shēngrì', meaning: 'Birthday - Date of birth', example: 'Example: 生日快乐！(Shēngrì kuàilè! - Happy birthday!)' },
            { char: '快乐', pinyin: 'kuàilè', meaning: 'Happy - Joyful, pleased', example: 'Example: 生日快乐！(Shēngrì kuàilè! - Happy birthday!)' },
            { char: '礼物', pinyin: 'lǐwù', meaning: 'Gift - Present', example: 'Example: 这是给你的礼物。(Zhè shì gěi nǐ de lǐwù. - This is a gift for you.)' },
            { char: '谢谢', pinyin: 'xièxie', meaning: 'Thank you - Expression of gratitude', example: 'Example: 谢谢你的礼物。(Xièxie nǐ de lǐwù. - Thank you for your gift.)' },
            { char: '送', pinyin: 'sòng', meaning: 'To give - To present', example: 'Example: 我送你礼物。(Wǒ sòng nǐ lǐwù. - I give you a gift.)' },
            { char: '月', pinyin: 'yuè', meaning: 'Month - Calendar month', example: 'Example: 一月 (yī yuè - January)' },
            { char: '号', pinyin: 'hào', meaning: 'Date - Day of the month', example: 'Example: 五月一号 (wǔ yuè yī hào - May 1st)' },
            { char: '星期', pinyin: 'xīngqī', meaning: 'Week - Seven-day period', example: 'Example: 星期一 (xīngqī yī - Monday)' },
            { char: '点', pinyin: 'diǎn', meaning: "O'clock - Hour of the day", example: 'Example: 三点 (sān diǎn - 3 o clock)' },
            { char: '分', pinyin: 'fēn', meaning: 'Minute - Unit of time', example: 'Example: 三点十分 (sān diǎn shí fēn - 3:10)' },
            { char: '爸爸', pinyin: 'bàba', meaning: 'Dad - Father', example: 'Example: 我爸爸 (wǒ bàba - my dad)' },
            { char: '妈妈', pinyin: 'māma', meaning: 'Mom - Mother', example: 'Example: 我妈妈 (wǒ māma - my mom)' },
            { char: '哥哥', pinyin: 'gēge', meaning: 'Older brother - Elder brother', example: 'Example: 我哥哥 (wǒ gēge - my older brother)' },
            { char: '姐姐', pinyin: 'jiějie', meaning: 'Older sister - Elder sister', example: 'Example: 我姐姐 (wǒ jiějie - my older sister)' },
            { char: '弟弟', pinyin: 'dìdi', meaning: 'Younger brother - Little brother', example: 'Example: 我弟弟 (wǒ dìdi - my younger brother)' },
            { char: '学习', pinyin: 'xuéxí', meaning: 'To study - To learn', example: 'Example: 学习汉语 (xuéxí Hànyǔ - study Chinese)' },
            { char: '汉语', pinyin: 'Hànyǔ', meaning: 'Chinese language - Mandarin', example: 'Example: 学习汉语 (xuéxí Hànyǔ - study Chinese)' },
            { char: '朋友', pinyin: 'péngyǒu', meaning: 'Friend - Companion', example: 'Example: 好朋友 (hǎo péngyǒu - good friend)' },
            { char: '名字', pinyin: 'míngzì', meaning: 'Name - Personal name', example: 'Example: 你叫什么名字？(Nǐ jiào shénme míngzì? - What is your name?)' },
            { char: '今天', pinyin: 'jīntiān', meaning: 'Today - This day', example: 'Example: 今天很好。(Jīntiān hěn hǎo. - Today is very good.)' }
        ];

        // Game state
        let currentChapter = 0;
        let currentTask = 0;
        let learnedCharacters = [];
        let correctAnswers = 0;
        let totalAttempts = 0;

        // DOM elements
        const chapterTitleEl = document.querySelector('.chapter-title');
        const npcImageEl = document.querySelector('.npc-image');
        const storyContentEl = document.querySelector('.story-content');
        const currentCharacterEl = document.getElementById('current-character');
        const pinyinEl = document.getElementById('pinyin');
        const meaningEl = document.getElementById('meaning');
        const exampleEl = document.getElementById('example');
        const answerInputEl = document.getElementById('answer-input');
        const submitBtn = document.getElementById('submit-btn');
        const resultMessageEl = document.getElementById('result-message');
        const storyProgressEl = document.getElementById('story-progress');
        const learningProgressEl = document.getElementById('learning-progress');
        const chapterNumEl = document.getElementById('chapter-num');
        const taskProgressEl = document.getElementById('task-progress');
        const learnedCountEl = document.getElementById('learned-count');
        const accuracyEl = document.getElementById('accuracy');
        const characterGridEl = document.getElementById('character-grid');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const celebrationEl = document.getElementById('celebration');

        // Initialize game
        function initGame() {
            displayChapter(currentChapter);
            displayTask(currentTask);
            updateProgress();
            renderCharacterGrid();
            
            // Add event listeners
            submitBtn.addEventListener('click', checkAnswer);
            answerInputEl.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    checkAnswer();
                }
            });
            
            prevBtn.addEventListener('click', prevTask);
            nextBtn.addEventListener('click', nextTask);
            
            // Start background music after user interaction
            document.addEventListener('click', function() {
                if (!musicPlaying) {
                    backgroundMusic.play();
                    musicControl.innerHTML = '<i>♫</i>';
                    musicPlaying = true;
                }
            }, { once: true });
        }

        // Display current chapter
        function displayChapter(chapterIndex) {
            const chapter = storyChapters[chapterIndex];
            chapterTitleEl.textContent = chapter.title;
            npcImageEl.textContent = chapter.npc;
            
            // Update story content
            let storyHTML = `<p>${chapter.story}</p>`;
            storyHTML += `<p><strong>Mission:</strong> ${chapter.task}</p>`;
            storyContentEl.innerHTML = storyHTML;
            
            // Update chapter info
            chapterNumEl.textContent = chapterIndex + 1;
        }

        // Display current task
        function displayTask(taskIndex) {
            const chapter = storyChapters[currentChapter];
            if (taskIndex >= 0 && taskIndex < chapter.characters.length) {
                const characterIndex = chapter.characters[taskIndex];
                const character = characters[characterIndex];
                
                currentCharacterEl.textContent = character.char;
                pinyinEl.textContent = character.pinyin;
                meaningEl.textContent = character.meaning;
                exampleEl.textContent = character.example;
                
                // Update task progress
                taskProgressEl.textContent = taskIndex + 1;
                
                // Clear input and result
                answerInputEl.value = '';
                resultMessageEl.textContent = '';
                resultMessageEl.className = '';
                
                // Focus on input
                answerInputEl.focus();
            }
        }

        // Check answer
        function checkAnswer() {
            const userAnswer = answerInputEl.value.trim().toLowerCase();
            const chapter = storyChapters[currentChapter];
            const characterIndex = chapter.characters[currentTask];
            const character = characters[characterIndex];
            
            // Simple answer validation
            const correctMeaning = character.meaning.toLowerCase();
            let isCorrect = false;
            
            // Check if answer contains keywords
            if (correctMeaning.includes('you') && userAnswer.includes('you')) {
                isCorrect = true;
            } else if (correctMeaning.includes('good') && userAnswer.includes('good')) {
                isCorrect = true;
            } else if (correctMeaning.includes('i/me') && (userAnswer.includes('i') || userAnswer.includes('me'))) {
                isCorrect = true;
            } else if (correctMeaning.includes('to call') && userAnswer.includes('call')) {
                isCorrect = true;
            } else if (correctMeaning.includes('to be') && userAnswer.includes('be')) {
                isCorrect = true;
            } else if (correctMeaning.includes('person') && userAnswer.includes('person')) {
                isCorrect = true;
            } else if (correctMeaning.includes('he') && userAnswer.includes('he')) {
                isCorrect = true;
            } else if (correctMeaning.includes('she') && userAnswer.includes('she')) {
                isCorrect = true;
            } else if (correctMeaning.includes('plural') && userAnswer.includes('plural')) {
                isCorrect = true;
            } else if (correctMeaning.includes('teacher') && userAnswer.includes('teacher')) {
                isCorrect = true;
            } else if (correctMeaning.includes('birthday') && userAnswer.includes('birthday')) {
                isCorrect = true;
            } else if (correctMeaning.includes('happy') && userAnswer.includes('happy')) {
                isCorrect = true;
            } else if (correctMeaning.includes('gift') && userAnswer.includes('gift')) {
                isCorrect = true;
            } else if (correctMeaning.includes('thank') && userAnswer.includes('thank')) {
                isCorrect = true;
            } else if (correctMeaning.includes('to give') && userAnswer.includes('give')) {
                isCorrect = true;
            } else if (correctMeaning.includes('month') && userAnswer.includes('month')) {
                isCorrect = true;
            } else if (correctMeaning.includes('date') && userAnswer.includes('date')) {
                isCorrect = true;
            } else if (correctMeaning.includes('week') && userAnswer.includes('week')) {
                isCorrect = true;
            } else if (correctMeaning.includes("o'clock") && (userAnswer.includes('clock') || userAnswer.includes('hour'))) {
                isCorrect = true;
            } else if (correctMeaning.includes('minute') && userAnswer.includes('minute')) {
                isCorrect = true;
            } else if (correctMeaning.includes('dad') && userAnswer.includes('dad')) {
                isCorrect = true;
            } else if (correctMeaning.includes('mom') && userAnswer.includes('mom')) {
                isCorrect = true;
            } else if (correctMeaning.includes('older brother') && (userAnswer.includes('brother') || userAnswer.includes('older'))) {
                isCorrect = true;
            } else if (correctMeaning.includes('older sister') && (userAnswer.includes('sister') || userAnswer.includes('older'))) {
                isCorrect = true;
            } else if (correctMeaning.includes('younger brother') && (userAnswer.includes('brother') || userAnswer.includes('younger'))) {
                isCorrect = true;
            } else if (correctMeaning.includes('to study') && (userAnswer.includes('study') || userAnswer.includes('learn'))) {
                isCorrect = true;
            } else if (correctMeaning.includes('chinese') && userAnswer.includes('chinese')) {
                isCorrect = true;
            } else if (correctMeaning.includes('friend') && userAnswer.includes('friend')) {
                isCorrect = true;
            } else if (correctMeaning.includes('name') && userAnswer.includes('name')) {
                isCorrect = true;
            } else if (correctMeaning.includes('today') && userAnswer.includes('today')) {
                isCorrect = true;
            }
            
            totalAttempts++;
            if (isCorrect) {
                correctAnswers++;
                resultMessageEl.textContent = 'Correct! Excellent work, Detective!';
                resultMessageEl.className = 'success';
                
                // Add to learned list (if not already there)
                if (!learnedCharacters.includes(characterIndex)) {
                    learnedCharacters.push(characterIndex);
                }
                
                // Show celebration and automatically
